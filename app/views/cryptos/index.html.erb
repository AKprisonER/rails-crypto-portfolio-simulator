<p id="notice"><%= notice %></p>
<h1>Cryptos Listing - <%= current_user.name%> </h1>
<br>
<table class="table table-striped table-hover table-responsive">
  <thead class="">
    <tr>
      <th>Symbol</th>
      <th>Name</th>
      <th>Current Price</th>
      <th>1 hr</th>
      <th>24 hr</th>
      <th>7 days</th>
      <th>Qty</th>
      <th>Buying Price</th>
      <th>Total Amount</th>
      <th>Balance</th>
      <th colspan="3" class="text-center"> Actions</th>
    </tr>
  </thead>

  <tbody>
    <% @cryptos.each do |crypto| %>
      <% if crypto.user_id == current_user.id %>
        <tr>
          <td><%= link_to crypto.symbol, crypto %></td>
          <% for c in @coins %>
            <% if crypto.symbol == c["symbol"] %>
              <td> <%= link_to c["name"], crypto %> </td>
              <td> $<%= c["price_usd"] %> </td>
              <td> <%= c["percent_change_1h"] %> % </td>
              <td> <%= c["percent_change_24h"] %> %</td>
              <td> <%= c["percent_change_7d"] %> %</td>
              <td><%= crypto.amount_owned.to_i %> </td>
              <td><%= number_to_currency(crypto.cost_per) %></td>
              <td> $<%= c["price_usd"].to_i * crypto.amount_owned.to_i %> </td>
              <td> $<%= (c["price_usd"].to_i * crypto.amount_owned.to_i)-(crypto.cost_per * crypto.amount_owned) %> </td>
              <td> $<% @balance += (c["price_usd"].to_i * crypto.amount_owned.to_i)-(crypto.cost_per * crypto.amount_owned) %> </td>
            <% end %>
          <% end %>
          <td><%= link_to 'Buy', edit_crypto_path(crypto) %></td>
          <td><%= link_to 'Sell', edit_crypto_path(crypto) %></td>
        </tr>
      <% end %>
    <% end %>
  </tbody>
</table>

<strong>Total Portfolio Balance: </strong> $<%= @balance %>
<br><br>

<%= link_to 'Buy Crypto', new_crypto_path, class: "btn btn-primary" %>
